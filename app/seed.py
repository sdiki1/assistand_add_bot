from __future__ import annotations

from sqlalchemy.ext.asyncio import AsyncSession

from app.models import Option, Question, Survey


async def seed_if_empty(session: AsyncSession) -> None:
    existing = await session.execute(
        Survey.__table__.select().limit(1)
    )
    if existing.first():
        return

    survey = Survey(code="assistant_v1", title="–ê–Ω–∫–µ—Ç–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞")
    session.add(survey)
    await session.flush()

    questions_data = [
        {
            "code": "fio",
            "text": "ü™™ –§–ò–û",
            "type": "text",
            "order": 1,
            "help_text": "–§–æ—Ä–º–∞—Ç: –§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ",
        },
        {
            "code": "contact",
            "text": "–ö–æ–Ω—Ç–∞–∫—Ç—ã",
            "type": "contact",
            "order": 2,
            "help_text": "–¢–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å–æ—Ü—Å–µ—Ç—å.",
        },
        {
            "code": "tasks",
            "text": "–ö–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ —Ç—ã —Ö–æ—á–µ—à—å (–∏ —É–º–µ–µ—à—å) –¥–µ–ª–∞—Ç—å?",
            "type": "multi_choice",
            "order": 3,
            "options": [
                "–í–µ–¥–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –≤—Å—Ç—Ä–µ—á, –ø–µ—Ä–µ–ª—ë—Ç–æ–≤",
                "–ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–¥–∞—á —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è",
                "–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –ø–æ–¥—Ä—è–¥—á–∏–∫–∞–º–∏",
                "–ü–æ–∏—Å–∫ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π",
                "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ / –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π",
                "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π / –ø–æ–µ–∑–¥–æ–∫",
                "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å / –æ—Ç—á—ë—Ç—ã / —Ç–∞–±–ª–∏—Ü—ã",
                "–í–µ–¥–µ–Ω–∏–µ –ª–∏—á–Ω—ã—Ö –¥–µ–ª —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è",
                "–õ–∏—á–Ω—ã–µ –ø–æ—Ä—É—á–µ–Ω–∏—è (–ø–æ–¥–∞—Ä–∫–∏, —Ö–∏–º—á–∏—Å—Ç–∫–∏, –∑–∞–ø–∏—Å–∏ –∫ –≤—Ä–∞—á–∞–º –∏ —Ç–¥)",
                "–ü–æ–ª–Ω—ã–π day-to-day –±—ã—Ç —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è",
                "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π SMM / –ø–æ—Å—Ç–∏–Ω–≥",
                "–•–æ–ª–æ–¥–Ω—ã–π –ø–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ–¥–∞–∂–∏",
            ],
        },
        {
            "code": "work_format",
            "text": "–§–æ—Ä–º–∞—Ç —Ä–∞–±–æ—Ç—ã",
            "type": "multi_choice",
            "order": 4,
            "options": ["–£–¥–∞–ª—ë–Ω–Ω–æ", "–ì–∏–±—Ä–∏–¥", "–¢–æ–ª—å–∫–æ –æ—Ñ–∏—Å"],
        },
        {
            "code": "conditions_schedule",
            "text": "–£—Å–ª–æ–≤–∏—è –∏ –≥—Ä–∞—Ñ–∏–∫",
            "type": "multi_choice",
            "order": 5,
            "options": [
                "–ì–æ—Ç–æ–≤–∞ –∫ –ø–µ—Ä–µ–µ–∑–¥—É",
                "–ì–æ—Ç–æ–≤–∞ –∫ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞–º",
                "–ü–æ–ª–Ω—ã–π –¥–µ–Ω—å",
                "–ß–∞—Å—Ç–∏—á–Ω–∞—è",
                "–ü—Ä–æ–µ–∫—Ç–Ω–∞—è",
                "–ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ",
            ],
        },
        {
            "code": "work_style",
            "text": "–°—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã",
            "type": "multi_choice",
            "order": 6,
            "options": [
                "–ë—ã—Å—Ç—Ä—ã–π, –¥–∏–Ω–∞–º–∏—á–Ω—ã–π",
                "–°–ø–æ–∫–æ–π–Ω—ã–π, —Å–∏—Å—Ç–µ–º–Ω—ã–π",
                "–ß—ë—Ç–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏ –¥–µ–¥–ª–∞–π–Ω—ã",
                "–£–≤–∞–∂–µ–Ω–∏–µ –∫ –ª–∏—á–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏",
                "–î–æ–≤–µ—Ä–∏–µ –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ",
                "–ë–µ–∑ –º–∏–∫—Ä–æ–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞",
                "–û—Ç–∫—Ä—ã—Ç—ã–π –∫ –¥–∏–∞–ª–æ–≥—É",
            ],
        },
        {
            "code": "spheres",
            "text": "–í –∫–∞–∫–∏—Ö —Å—Ñ–µ—Ä–∞—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å?",
            "type": "multi_choice",
            "order": 7,
            "options": [
                "IT / —Å—Ç–∞—Ä—Ç–∞–ø—ã",
                "–û–Ω–ª–∞–π–Ω-–±–∏–∑–Ω–µ—Å / –∏–Ω—Ñ–æ–±–∏–∑–Ω–µ—Å",
                "E-commerce",
                "–ü—Ä–æ–¥–∞–∫—à–Ω / –º–µ–¥–∏–∞ / –±–ª–æ–≥–µ—Ä—ã",
                "–ö–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥",
                "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ / —Ñ–∏–Ω–∞–Ω—Å—ã",
                "–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã",
                "–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏",
                "–ì–æ—Å—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
            ],
        },
        {
            "code": "tech_skills",
            "text": "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏",
            "type": "multi_choice",
            "order": 8,
            "options": [
                "Google Workspace / Notion / Trello / Asana / Week",
                "–†–∞–±–æ—Ç–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º",
                "–¢–∞–±–ª–∏—Ü—ã –∏ –æ—Ç—á—ë—Ç—ã",
                "–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏",
                "–î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç",
                "–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏",
                "–†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π/–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π",
                "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã / –±—é–¥–∂–µ—Ç—ã",
                "–†–∞–±–æ—Ç–∞ —Å –ø–æ–¥—Ä—è–¥—á–∏–∫–∞–º–∏",
            ],
        },
        {
            "code": "salary",
            "text": "–ó–∞—Ä–ø–ª–∞—Ç–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è",
            "type": "single_choice",
            "order": 9,
            "options": [
                "–î–æ 50 000‚ÇΩ",
                "50 000‚ÇΩ ‚Äì 80 000‚ÇΩ",
                "80 000‚ÇΩ ‚Äì 120 000‚ÇΩ",
                "120 000‚ÇΩ ‚Äì 160 000‚ÇΩ",
                "160 000‚ÇΩ+",
            ],
        },
        {
            "code": "official_contract",
            "text": "–ù—É–∂–µ–Ω –ª–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä?",
            "type": "single_choice",
            "order": 10,
            "options": ["–î–∞", "–ù–µ—Ç", "–ù–µ –≤–∞–∂–Ω–æ"],
        },
        {
            "code": "overtime",
            "text": "–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –Ω–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –≥—Ä–∞—Ñ–∏–∫—É",
            "type": "single_choice",
            "order": 11,
            "options": ["–î–∞", "–ù–µ—Ç", "–ì–æ—Ç–æ–≤–∞ –æ–±—Å—É–¥–∏—Ç—å"],
        },
        {
            "code": "growth",
            "text": "–í–∞–∂–Ω–æ –ª–∏ –æ–±—É—á–µ–Ω–∏–µ / —Ä–æ—Å—Ç?",
            "type": "single_choice",
            "order": 12,
            "options": ["–í–∞–∂–Ω–æ", "–ù–µ –≤–∞–∂–Ω–æ", "–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"],
        },
        {
            "code": "positioning",
            "text": "–ö–æ—Ä–æ—Ç–∫–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (2‚Äì4 —Å—Ç—Ä–æ–∫–∏)",
            "type": "text",
            "order": 13,
            "help_text": "–û–ø–∏—à–∏—Ç–µ –∫–ª—é—á–µ–≤—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å, —Å—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã –∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã.",
        },
        {
            "code": "files",
            "text": "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–µ–∑—é–º–µ –∏/–∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
            "type": "file",
            "order": 14,
            "help_text": "–ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å PDF, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –∫—Ä—É–∂–æ–∫ –∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.",
        },
    ]

    questions = []
    for item in questions_data:
        options = item.pop("options", [])
        question = Question(survey_id=survey.id, **item)
        if question.type == "multi_choice":
            question.allow_multiple = True
        session.add(question)
        await session.flush()
        questions.append(question)
        for idx, opt in enumerate(options, start=1):
            session.add(Option(question_id=question.id, text=opt, value=opt, order=idx))

    await session.commit()
